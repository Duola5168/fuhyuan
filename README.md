# 富元機電 - 工作服務單應用程式 (V1.7)

這是一個現代、高效的網頁應用程式，旨在數位化並簡化建立、管理及分享工作服務單的流程。它特別為需要在現場工作的服務人員設計，提供了一個從資料填寫到客戶簽名、再到 PDF 報告產出的一站式解決方案。

## ✨ V1.7 重大更新：全自動 Dropbox 認證

*   **🔒 OAuth 2.0 整合**：導入業界標準的 Dropbox OAuth 2.0 授權流程，徹底解決存取權杖 (Access Token) 過期的問題。
*   **🤖 自動權杖更新**：首次授權後，應用程式會**自動在背景更新權杖**。您再也不需要手動去 Dropbox 開發者後台產生或更新權杖。
*   **✨ 使用者體驗提升**：在介面中增加了清晰的 Dropbox 連線狀態指示，讓您隨時了解連線狀況。登入/登出流程無縫整合。
*   **📄 全新設定教學**：`README.md` 文件已更新，提供完整的 OAuth 2.0 設定指南，引導您設定 App Key, App Secret 以及最重要的**重新導向 URI (Redirect URI)**。

---

## 🛠️ Dropbox 整合設定 (OAuth 2.0) - 一次性設定

為了讓應用程式能夠自動、安全地連接到您的 Dropbox，請依照以下步驟進行一次性設定。

### 步驟 1：建立 Dropbox 應用程式

1.  前往 [Dropbox App Console](https://www.dropbox.com/developers/apps)。
2.  點擊 **"Create app"** 按鈕。
3.  選擇 **"Scoped access"**。
4.  在 "Choose the type of access you need" 下，選擇 **"App folder"** – 這會將應用程式的存取權限限制在一個專屬的資料夾內，最為安全。
5.  為您的應用程式命名，例如 `富元工作服務單上傳工具`，然後點擊 **"Create app"**。

### 步驟 2：設定應用程式權限

1.  建立後，您會被導向應用程式的管理頁面。
2.  切換到 **"Permissions"** 分頁。
3.  在權限列表中，找到並勾選 **`files.content.write`**。這是允許應用程式上傳檔案到其專屬資料夾的唯一權限。
4.  點擊右下角的 **"Submit"** 按鈕儲存變更。



### 步驟 3：設定重新導向 URI (關鍵步驟！)

1.  切換到 **"Settings"** 分頁。
2.  找到 **"OAuth 2"** 區塊下的 **"Redirect URIs"** 欄位。
3.  **非常重要：** 在這裡，您需要新增您的應用程式部署後的網址。
    *   **如果您使用 Netlify**：請填入您 Netlify 網站的完整網址，例如 `https://fuyuan-work-order.netlify.app`。
    *   **如果您在本地開發**：請新增 `http://localhost:5173` (或您本地開發伺服器使用的埠號)。
4.  點擊 **"Add"** 按鈕。您可以同時新增多個 URI。



### 步驟 4：取得 App Key 和 App Secret

1.  在同一個 **"Settings"** 分頁，向上捲動到頂部。
2.  您會看到 **"App key"** 和 **"App secret"**。請複製這兩組值。



### 步驟 5：在 Netlify 中設定環境變數

1.  登入您的 Netlify 帳戶，並進入您的專案。
2.  前往 **"Site settings"** > **"Build & deploy"** > **"Environment"**。
3.  點擊 **"Edit variables"**，並新增以下三個變數：
    *   `DROPBOX_APP_KEY`: 貼上您剛剛複製的 **App key**。
    *   `DROPBOX_APP_SECRET`: 貼上您剛剛複製的 **App secret**。
    *   `DROPBOX_REDIRECT_URI`: 貼上您在步驟 3 設定的 **Netlify 網址**。

完成以上步驟後，您的應用程式就設定完成了！

---

## ✨ 功能亮點

*   **✨ AI 智慧建議**：整合 Google Gemini AI，可根據「處理事項」和「產品項目」自動產生專業的「處理情形」報告內容，大幅提升填寫效率。
*   **📄 直覺的表單介面**：清晰易用的表單，包含所有必要欄位。
*   **✍️ 數位簽名**：服務人員與客戶可以直接在裝置螢幕上簽名。
*   **📸 現場照片上傳**：可直接使用裝置相機拍照或從相簿上傳多張現場照片。
*   **💾 本機暫存系統**：可將未完成的服務單儲存為多個本地暫存檔。
*   **☁️ 雲端儲存與同步**：
    *   **Dropbox**：採用 OAuth 2.0，可將 PDF 服務單**安全、自動地**上傳歸檔。
    *   **Google Drive**：可將暫存檔安全地匯出/匯入至您的 Google 雲端硬碟。
*   **🚀 即時 PDF 產生與分享**：一鍵產生專業、排版精美的 PDF 服務單報告。
*   **🔒 安全第一**：所有 API 金鑰等敏感資訊採用業界標準的環境變數進行管理，授權流程安全可靠。
*   **📱 跨裝置相容**：採用響應式設計，在手機、平板和桌上型電腦上都能提供良好的操作體驗。
